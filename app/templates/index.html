<!DOCTYPE html>
<head>
  <title>Futurama Data from different places</title>
  <link rel="stylesheet" type="text/css" href="/static/stylesheets/main.css">
</head>
<body>
  <div class='main'>
    <div class='main'>Below are the details for <span class='boldy'>{{ tree }}</span></div>
    <div class='yetAnotherContainer'>
        <div class='backouts floaty'><div class='omg'>{{ backouts['backouts'] }}</div><br> backouts were performed for {{ backouts['total'] }}     pushes since the beginning of {{ backouts['startdate'] }} (roughly the last 7 days). Merges are not counted</div>
        <div class='backouts floaty'><div class='omg'>{{ today['backouts'] }}</div><br> backouts were performed for {{ today['total'] }}     pushes since the beginning of today. Merges are not counted</div>
    </div>
    <div class='floaty wide' id="closuresContainer"></div>
    <div class='floaty wide' id="backoutPerHourContainer"></div>
    <div class='floaty small' id='backoutsVsPushContainer'></div>
    <div class='floaty small' id='backoutsVsPushAverageContainer'></div>

    <div><a href="/?tree=mozilla-inbound">Mozilla-Inbound</a> | <a href="/?tree=mozilla-central">Mozilla-Central</a> |
         <a href="/?tree=fx-team">FX-Team</a></div>
  </div>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  <script src="http://code.highcharts.com/highcharts.js"></script>
  <script type="text/javascript">
  $(function () {
      $('#closuresContainer').highcharts({
          chart: {
              type: 'area'
          },
          title: {
              text: 'closures'
          },
          xAxis: {
            categories: {{ total["x"]|safe }},
          },
          yAxis: {
            title: {
              text: "Closure in hours",
            },
          },
          series: [
          {% for tot in total["y"] %}
          {
              name: "{{ tot }}",
              data: {{ total["y"][tot] }}
          },
          {% endfor %}
          ],
          plotOptions: {
            area: {
                stacking: 'normal',
            },
          }
      });

      $('#backoutPerHourContainer').highcharts({
          chart: {
              defaultSeriesType: 'column'
          },
          title: {
              text: 'Backouts Per Hour'
          },
          xAxis: {
            categories: [{% for key, value in backout_hours|dictsort %}
                          {{ key|safe}},
                         {% endfor %}]
          },
          yAxis: {
            title: {
              text: "backouts per hour",
            },
          },
          series: [{
            name: "Backouts Per Hour",
            data: [{% for key, value in backout_hours|dictsort %}
                          {{ value}},
                         {% endfor %}]
            },
            {
              name: "Backouts per hour for last week",
              data: [{% for key, value in backouts["backoutHours"]|dictsort %}
                            {{ value}},
                           {% endfor %}]
          }],
          plotOptions: {
          },
          legend: {
            layout: 'horizontal',
            floating: true,
            backgroundColor: '#FFFFFF',
            align: 'right',
            verticalAlign: 'top',
            y: 60,
            x: -60
          },
      });
      $('#backoutsVsPushContainer').highcharts({
        chart: {
          type: 'line',
        },
        title: {
          'text': 'Pushes and Backouts',
        },
        xAxis: {
          categories: {{ historic['dates']|safe }},
        },
        yAxis: {
          title: {
            text: "Pushes",
          },
        },
        series: [
          {
            name: "backouts",
            data: {{ historic["backouts"] }}
          },
          {
            name: "pushes",
            data: {{ historic["total"] }}
          },
        ],
      });
      $('#backoutsVsPushAverageContainer').highcharts({
        chart: {
          type: 'line',
        },
        title: {
          'text': 'Monthly Pushes per Backout',
        },
        xAxis: {
          categories: {{ historic['dates']|safe }},
          title: {
            text: "Month"
          }
        },
        yAxis: {
          title: {
            text: "Pushes / Backouts",
          },
        },
        series: [
          {
            name: "backout/push ratio",
            data: {{ historic["ratio"] }}
          },
        ],
      });
  });
  </script>
</body>
